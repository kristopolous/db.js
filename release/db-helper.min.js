DB.sum=DB.reduceLeft(function(n,r,e){return n+r[e]}),DB.max=DB.reduceLeft(Number.MIN_VALUE,function(n,r,e){return r[e]>n?r[e]:n}),DB.min=DB.reduceLeft(Number.MAX_VALUE,function(n,r,e){return r[e]<n?r[e]:n}),DB.tabular=function(e,n){var t,r=(n=n||{}).order,c=n.row_key,u=n.col_key,i=n.cell_key,o=n.agg||DB.sum,a=n.row_order||e.distinct(c),f=n.col_order||e.distinct(u),B={},n=[n.header||[n.name||c].concat(f)];return DB.isString(i)?DB.each(f,function(n){B[n]=i}):B=i,a=DB.map(a,function(n){var r=e.find(c,n);return[n].concat(DB.map(f,function(n){return o(r.find(u,n),B[n])||0}))}),DB.isString(r)&&(t=f.indexOf(r)+1,r=function(n,r){return r[t]-n[t]}),DB.isFunction(r)&&(a=a.sort(r)),n.concat(a)};